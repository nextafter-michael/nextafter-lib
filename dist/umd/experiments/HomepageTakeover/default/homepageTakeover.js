!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.homepageTakeover=t():e.homepageTakeover=t()}(this,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{config:()=>s,default:()=>main,variables:()=>a});class o{static defaultOptions={buttonTextHTMLHTML:"Go Back",href:"javascript:void(0)",design:{top:"1rem",left:"1rem",color:"#fff",backgroundColor:"#007bff",border:"none",borderRadius:"1rem",padding:"0.5rem 1rem"}};constructor(e={}){e={...o.defaultOptions,...e};const t={...o.defaultOptions.design,...e.design};delete e.design;const n=document.createElement("div");n.classList.add("homepage-takeover-button-container"),n.style.setProperty("position","fixed"),n.style.setProperty("z-index","65536"),n.style.setProperty("top",0),n.style.setProperty("left",0),n.style.setProperty("padding-top",t.top),n.style.setProperty("padding-left",t.left),n.style.setProperty("max-width","100%");const r=document.createElement("a");r.style.setProperty("display","contents"),r.href=e.href,"javascript:void(0)"===r.href&&r.addEventListener("click",(e=>{if(e.preventDefault(),window.location.searchParams.has("fromUrl")){const e=window.location.searchParams.get("fromUrl");window.location.href=e}else window.history.length>1?window.history.back():window.location.href="/"}));const i=document.createElement("button");return i.classList.add("homepage-takeover-button"),i.innerHTML=e.buttonTextHTML,Object.entries(t).filter((([e])=>"top"!==e&&"left"!==e)).forEach((([e,t])=>{i.style.setProperty(e,t)})),n.appendChild(r),r.appendChild(i),document.body.appendChild(n),this.element=i,this}}class n{static defaultOptions={homepageUrl:null,destinationUrl:null,srcParamValue:"redirect",redirectCooldownDays:7,cookieName:"homepageTakeoverRedirected",buttonTextHTML:"Go Back",buttonDesign:o.defaultOptions.design};static executeRedirect=function(e){if(!e)return console.warn("No destination URL provided.");e instanceof URL?window.location.assign(e.href):"string"==typeof e&&(e.startsWith("javascript:")||window.location.assign(e))};constructor(e={}){if(this.options={...n.defaultOptions,...e},!this.options.destinationUrl)return console.warn("HomepageTakeover: destinationUrl is required.");const t=new URL(window.location.href),o=e=>e.pathname.replace(/\/+$/,""),r=e=>{const t=new URL(this.options.destinationUrl,window.location.origin);return o(e)===o(t)};return(e=>{const t=new URL(this.options.homepageUrl,window.location.origin);return o(e)===o(t)})(t)?(this.handleHomepage(),!0):r(t)&&(e=>{const t=(e=e instanceof URL?e:new URL(e,window.location.origin)).searchParams.get("fromUrl");return t&&decodeURIComponent(t)===this.options.homepageUrl})(t)?(this.handleDestinationPage(),!0):(r(t),!1)}handleHomepage(){const e=new URL(window.location.href),t=e.searchParams,o=t.get("fromUrl");if(o){decodeURIComponent(o)}else{const o=localStorage.getItem(this.options.cookieName),r=(new Date).getTime(),i=24*this.options.redirectCooldownDays*60*60*1e3;if(!o||r-parseInt(o,10)>i){const o=new URL(this.options.destinationUrl,window.location.origin);["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach((e=>{t.has(e)&&!o.searchParams.has(e)&&o.searchParams.set(e,t.get(e))})),this.options.srcParamValue&&o.searchParams.set("src",this.options.srcParamValue),o.searchParams.set("fromUrl",encodeURIComponent(e.href)),n.executeRedirect(o.href),localStorage.setItem(this.options.cookieName,r.toString())}}}handleDestinationPage(){const e=new URL(window.location.href).searchParams.get("fromUrl");if(!e)return console.warn("No fromUrl parameter found in the URL.");const t=decodeURIComponent(e);new o({buttonTextHTML:this.options.buttonTextHTML,href:t,design:this.options.buttonDesign})}}const r=n,i=[{name:"Homepage URL",mapsTo:"homepageUrl",type:"text:url",unit:null,value:"https://nextafter.com/",description:"The URL of the homepage where the redirect will occur."},{name:"Destination URL",mapsTo:"destinationUrl",type:"text:url",unit:null,value:"https://nextafter.com/",description:"The URL to which the user will be redirected."},{name:"src Param Value",mapsTo:"srcParamValue",type:"text",unit:null,value:"redirect",description:"The value of the src parameter to be added to the destination URL."},{name:"Redirect Cooldown Days",mapsTo:"redirectCooldownDays",type:"number",unit:null,value:7,description:"The number of days to wait before redirecting the user again."},{name:"Cookie Name",mapsTo:"cookieName",type:"text",unit:null,value:"homepageTakeoverRedirected",description:"The name of the cookie to be set for the redirect."},{name:"Button Text HTML",mapsTo:"buttonTextHTML",type:"text:rich",unit:null,value:"Go Back",description:"The text to be displayed on the back button on the redirected page."},{name:"Design",mapsTo:"buttonDesign",type:"group:collapsed",items:[{group_index:0,name:"Button Position Top",mapsTo:"design.top",type:"text",unit:"px",value:16},{group_index:1,name:"Button Position Left",mapsTo:"design.left",type:"text",unit:"px",value:16},{group_index:2,name:"Button Background Color",mapsTo:"design.backgroundColor",type:"text:color",unit:null,value:"#000000"},{group_index:3,name:"Button Text Color",mapsTo:"design.color",type:"text:color",unit:null,value:"#FFFFFF"},{group_index:4,name:"Button Border Radius",mapsTo:"design.borderRadius",type:"number",unit:"px",value:4},{group_index:5,name:"Button Padding",mapsTo:"design.padding",type:"text",unit:null,value:"8px 16px"}]}];function main(e){return new r(e)}function a(){return i}function s(){return r.defaultOptions}return t})()));